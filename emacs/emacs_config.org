#+PROPERTY: header-Ares :results none :tangle ~/.emacs.d/init.el
Title: Emacs Configuration
#+auto_tangle: t


* About this config
This is my first attempt at a fully-feature emacs configuration. In many ways, I have little idea of what I'm doing. I've used emacs for years without these features, but with the advent of LSP would like to learn more about to make emacs work the best for my workflow as possible. I've learned a lot via DOOM emacs, but now I want to ensure I have a system that caters to my personal need.

* Setup:
I got tired of emacs asking if it was ok to follow a symlink on every boot and the attempts I made to suppress that didn't work. So instead, we tangle directly to =init.el= and save this org file under version control.

* Initial Quick setup
These are the random one-off configurations that help make Emacs better, but didn't fall into a great category.  Things like removing the unneeded ui elements from the screen or suppressing annoying dialogs that you always answer yes to.
** Remove some of the features of the UI that we don't need (toolbars, menubars, scroll bars, and splash screen)
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;;-*- lexical-binding: t; -*-
  ;; Don't show the splash screen
  (setq inhibit-startup-message t)
  (setq initial-buffer-choice nil)
  ;; Tune garbage collection
  (setq gc-cons-threshold (* 50 1000 1000))

  ;; Turn off some unneeded UI Elements
  (menu-bar-mode -1)
  (tool-bar-mode -1)
  (scroll-bar-mode -1)
  (display-time-mode 1)
#+END_SRC
** Turn on centered-cursor-mode
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
      (use-package centered-cursor-mode
      :ensure t
    :config
  (global-centered-cursor-mode +1))
#+end_src
** Make deleted files go to trash
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (setq delete-by-moving-to-trash t
trash-directory "~/.local/share/Trash/files/")
#+end_src

** Turn on beacon
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package beacon
    :ensure t
    :config
    (beacon-mode +1))
#+end_src

** DONE Suppress execute confirm
CLOSED: [2022-12-28 Wed 17:26]
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
 (setq org-confirm-babel-evaluate nil)
#+end_src
** DONE Keep little files from littering
CLOSED: [2022-12-28 Wed 18:13]
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(use-package no-littering :ensure t)
#+end_src

** DONE Suppress compiler warnings
CLOSED: [2022-12-28 Wed 17:27]
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none

;; Silence compiler warnings as they can be pretty disruptive
(setq native-comp-async-report-warnings-errors nil)

;; Set the right directory to store the native comp cache
(add-to-list 'native-comp-eln-load-path (expand-file-name "eln-cache/" user-emacs-directory))

#+end_src

** Load custom lisp files
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (load (expand-file-name "rc-funcs.el" user-emacs-directory))
  (setq custom-file (expand-file-name "custom.el" user-emacs-directory))
  (load custom-file)
#+end_src

#+RESULTS:
** Suppress emacs from asking if it should follow symlink files
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
(setq vc-follow-symlinks t)
(setq vc-suppress-confirm t)
#+end_src
** Turn on line numbers
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Turn on line numbers in every buffer
  (global-display-line-numbers-mode 1)
  ;; With vim bindings, relatives let us use j and k better
  (setq display-line-numbers-type 'relative)
#+END_SRC
** Disable lockfiles
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
(setq create-lockfiles nil)
#+end_src

** Line Highlighting and Fringe
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Turn on line highlithting for current line
  (hl-line-mode 1)
  ;; Add some margins
  (set-fringe-mode 10)
#+END_SRC
** Add escape to kill prompts
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Make escape kill prompts
  (global-set-key (kbd "<escape>") 'keyboard-escape-quit)
#+END_SRC
** Keys for Mac
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (setq mac-command-modifier       'meta
        mac-option-modifier        'meta
        mac-control-modifier       'control
        mac-right-option-modifier     'meta
        mac-right-control-modifier  'control)
#+end_src

#+RESULTS:
: control
** DONE Turn on garbage collection
CLOSED: [2022-12-28 Wed 18:13]
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package gcmh
  :diminish gcmh-mode
  :config
  (setq gcmh-idle-delay 5
        gcmh-high-cons-threshold (* 16 1024 1024))  ; 16mb
  (gcmh-mode 1))

(add-hook 'emacs-startup-hook
          (lambda ()
            (setq gc-cons-percentage 0.1))) ;; Default value for `gc-cons-percentage'

(add-hook 'emacs-startup-hook
          (lambda ()
            (message "Emacs ready in %s with %d garbage collections."
                     (format "%.2f seconds"
                             (float-time
                              (time-subtract after-init-time before-init-time)))
                     gcs-done)))


#+end_src
** Manage how new windows are placed
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (setq display-buffer-base-action
    '((display-buffer-reuse-window
       display-buffer-reuse-mode-window
       display-buffer-same-window
       display-buffer-in-previous-window)))
#+end_src

* Setup our package manager
** Define where we go for packages

** Straight.el
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(defvar bootstrap-version)
(let ((bootstrap-file
       (expand-file-name "straight/repos/straight.el/bootstrap.el" user-emacs-directory))
      (bootstrap-version 6))
  (unless (file-exists-p bootstrap-file)
    (with-current-buffer
        (url-retrieve-synchronously
         "https://raw.githubusercontent.com/radian-software/straight.el/develop/install.el"
         'silent 'inhibit-cookies)
      (goto-char (point-max))
      (eval-print-last-sexp)))
  (load bootstrap-file nil 'nomessage))
#+end_src

#+RESULTS:

** Setup use-package

#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
;;Initalize use-package
(unless (package-installed-p 'use-package)
(package-install 'use-package))

(require 'use-package)
(require 'quelpa-use-package)

#+END_SRC

* Build the UI we want
** Install a better mode line

#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package doom-modeline
    :ensure t
    :init (doom-modeline-mode 1)
    :config
    (setq doom-modeline-hud nil)
    (setq doom-modeline-minor-modes nil)
    (setq rc-doom-modeline-text-height 200)
    (setq doom-modeline-height 35)
    )
  (use-package all-the-icons
    :ensure t
    :if (display-graphic-p))

#+END_SRC
** Themes:
*** Setup Modus Themes

I like to do this even if I don't plan on the modus themes being my main theme of choice. I often swap themes, and this way they are ready when I want them.
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package modus-themes
  :ensure t
  :init
  (setq modus-themes-hl-line '(intense)
  modus-themes-subtle-line-numbers nil
  modus-themes-region '(no-extend bg-only)
  modus-themes-variable-pitch-ui nil
  modus-themes-fringes 'intense
  modus-themes-diffs nil
  modus-themes-italic-constructs t
  modus-themes-bold-constructs  t
  modus-themes-prompts '( bold intense italic)
  modus-themes-intense-mouseovers t
  modus-themes-paren-match '(bold intense)
  modus-themes-syntax '( yellow-comments)
  modus-themes-links '(neutral-underline background)
  modus-themes-mode-line '(moody borderless accented 4 1)
  modus-themes-headings
   '((1 . (variable-pitch 1.1 rainbow))
                         (2 . (regular))
                         (3 . (regular))
                         (4 . (regular))
                         (t . (rainbow)))
  modus-themes-org-blocks `gray-background
   ))




#+END_SRC

#+RESULTS:
: t
*** doom-themes
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package doom-themes
  :after mixed-pitch
    :ensure t
    :config
    (setq doom-themes-enable-bold t
          doom-themes-enable-italic t)
    (load-theme 'doom-1337 t)

    (doom-themes-visual-bell-config)
    (doom-themes-neotree-config)
    (setq doom-themes-treemacs-theme "doom-atom")
    (doom-themes-treemacs-config)
    (doom-themes-org-config))
#+end_src
*** Kaolin Themes
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
    (use-package kaolin-themes
      :ensure t
      :config
      (setq kaolin-themes-modeline-border nil)
  )
#+end_src
*** Ef-themes
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
    (use-package ef-themes
      :ensure t
      :init
      (setq ef-themes-headings
	    (quote ((1 . (variable-pitch 1.1))
		    (2 . (regular))
		    (3 . (regular))
		    (4 . (regular))))))
#+end_src
*** Set out theme
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (load-theme 'doom-acario-dark t)
#+end_src


** Setup our fonts
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
 (set-face-attribute 'default nil :family "Anonymice Nerd Font Mono" :height 220)

 ;; Proportionally spaced typeface
 (set-face-attribute 'variable-pitch nil :family "OpenDyslexicAlta NF" :height 1.0)

 ;; Monospaced typeface
 (set-face-attribute 'fixed-pitch nil :family "Comic Sans MS" :height 1.5)


 (if (facep 'mode-line-active)
     (set-face-attribute 'mode-line-active nil :family "Spleen 32x64" :height 200) ; For 29+
   (set-face-attribute 'mode-line nil :family "Spleen 32x64" :height 200))
(set-face-attribute 'mode-line-inactive nil :family "Anonymice Nerd Font Mono" :height 200)
#+END_SRC
** Update the help docs

#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
(use-package helpful
  :ensure t)
(global-set-key (kbd "C-c C-d") #'helpful-at-point)
(global-set-key (kbd "C-h F") #'helpful-function)
(global-set-key (kbd "C-h C") #'helpful-command)
(setq counsel-describe-function-function #'helpful-callable)
(setq counsel-describe-variable-function #'helpful-variable)

#+END_SRC
** Popper.el - tame popups
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package popper
    :ensure t
    :bind (("C-`" . popper-toggle-latest) 
           ("M-`" . popper-cycle)
           ("C-M-`" . popper-toggle-type))
    :init
    (setq popper-reference-buffers
          '("\\*Messages\\*"
            "Output\\*$"
            "\\*Warnings\\*"
            "\\*Backtrace\\*"
            help-mode
            helpful-mode
            compilation-mode))
    (popper-mode +1)
    (popper-echo-mode +1)
    )


  (defvar rcool/help-temp-buffers '("^\\*Help\\*$",
                                    "^\\*helpful command"))

  (while rcool/help-temp-buffers
    (add-to-list 'display-buffer-alist
                 `(,(car rcool/help-temp-buffers)
                   (display-buffer-in-side-window
                    (side . left)
                    (window-width . 50))))

    (setq rcool/help-temp-buffers (cdr rcool/help-temp-buffers)))
#+end_src

** Key bindings with general
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package general
    :ensure t
    :config
    (general-auto-unbind-keys)
    (general-evil-setup t))



  #+end_src

** Ace window
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
    (use-package ace-window :defer t :ensure t)
#+end_src
** Diminish
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
    (use-package diminish :ensure t)
#+end_src
                            
*** TEXmode
#+begin_src emacs-lisp :results none :tange ~/.emacs.d/init.el
                         (use-package tsx-mode
                           :ensure t
                           :straight '(tsx-mode
                                       :type git :host github
                                       :repo "orzechowskid/tsx-mode.el"
                                       :branch "emacs29"))
                              (use-package coverlay
                                :ensure t
                                :straight '(coverlay :type git
                                                     :host github :repo "twada/coverlay.el"))
                              (use-package css-in-js-mode
                                :ensure t :straight '(css-in-js-mode :type git :host github :repo "orzechowskid/tree-sitter-css-in-js"))
                         (use-package origami :ensure t
                           :straight '(origamd
                                       i :type git
                                       :host github
                                       :repo "gregsexton/origami.el"))
#+end_src
*** TSI.el
=tsi.el= provides a tree-sitter powered set of indentation rules for ts, json, and css files
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
    (use-package tsi
:ensure t
          :after tree-sitter
          :quelpa (tsi :fetcher github :repo "orzechowskid/tsi.el")
          ;; define autoload definitions which when actually invoked will cause package to be loaded
          :commands (tsi-typescript-mode tsi-json-mode tsi-css-mode)
          :init
          (add-hook 'typescript-mode-hook (lambda () (tsi-typescript-mode 1)))
          (add-hook 'tsx-ts-mode-hook (lambda () (tsi-typescript-mode 1)))
          (add-hook 'js-mode-hook (lambda () (tsi-typescript-mode 1)))
          (add-hook 'json-mode-hook (lambda () (tsi-json-mode 1)))
          (add-hook 'css-mode-hook (lambda () (tsi-css-mode 1)))
          (add-hook 'scss-mode-hook (lambda () (tsi-scss-mode 1))))
#+end_src

#+RESULTS:
| lambda  | nil | (tsi-scss-mode 1) |                   |
| closure | (t) | nil               | (tsi-scss-mode 1) |

*** Formatting on Save
We use =apheleia= to handle our formatting. This packages can do many different languages so including it here will
benefit others as well.

#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package apheleia
    :ensure t
  :diminish
    :config
    (apheleia-global-mode +1))
 #+end_src

** Simple Lua
*** Enable =lua-mode=

#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el :results none 
  (use-package lua-mode
    :ensure t
    :after (tree-sitter lsp-mode)
  :init
    (add-to-list 'auto-mode-alist '("\\.lua\\'" . lua-mode))
    (add-to-list 'interpreter-mode-alist '("lua" . lua-mode))
  )
#+END_SRC

* Completion
** Install Company Mode
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el :results none 
  (use-package company
    :ensure t
    :after lsp-mode
    :hook (prog-mode . company-mode)
    :bind (:map company-active-map
                ("<tab>" . company-complete-selection))
    (:map lsp-mode-map
          ("<tab>" . company-indent-or-complete-common))
    :custom
    (company-minimum-prefix-length 1)
    (company-idle-delay 0.0))

  #+end_src


** Add LSP UI
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
    (use-package lsp-ui
      :ensure t
      :hook ((lsp-mode . lsp-ui-mode)
  (lsp-mode . lsp-ui-sideline-mode))
      :config
  (setq lsp-ui-sideline-show-hover t)
    (setq lsp-ui-doc-position 'top))
#+end_src 

** Treemacs
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package treemacs
    :ensure t
    :defer t
    :config
    (setq treemacs-position 'right
          width 50))
#+end_src


*** LSP Treemacs
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package lsp-treemacs
    :ensure t
  :after lsp)
#+end_src


*** Treemacs-evil
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package treemacs-evil
    :ensure t
    :config
    )

#+end_src


*** Treemacs-projectile
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package treemacs-projectile
    :ensure t
    )

#+end_src



*** treemacs-magit
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package treemacs-magit
    :ensure t
    )

#+end_src


*** treemacs-icons-dired
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(use-package treemacs-icons-dired :ensure t)
#+end_src


*** treemacs-perspective
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(use-package treemacs-perspective :ensure t)
#+end_src


*** treemacs-all-the-icons
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(use-package treemacs-all-the-icons :ensure t)
#+end_src



** Ivy
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el

  (use-package ivy
    :ensure t
    :diminish 
    :config
    (setq ivy-use-virtual-buffers t)
    (setq ivy-count-format "(%d/%d) ")
    (ivy-mode 1)
    )
  #+end_src
** Prescient
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
      (use-package prescient
    :after counsel
      :ensure t)
  (use-package ivy-prescient :ensure t
    :config
  (ivy-prescient-mode))
  
#+end_src

** Faster Symbol searches
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package lsp-ivy
    :ensure t)
#+end_src


** Ivy Rich
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el

  (use-package ivy-rich
    :ensure t
    :init
    (ivy-rich-mode 1)
   :config
   (setq ivy-format-function #'ivy-format-function-line)
   (setq ivy-rich-display-transformers-list
         (plist-put ivy-rich-display-transformers-list
                    'ivy-switch-buffer
                    '(:columns
                      ((ivy-rich-candidate (:width 40))
                       (ivy-rich-switch-buffer-indicators (:width 4 :face error :align right))
                       (ivy-rich-switch-buffer-major-mode (:width 12 :face warning))
                       (ivy-rich-switch-buffer-project (:width 15 :face success))
                       (ivy-rich-switch-buffer-path (:width (lambda(x) (ivy-rich-switch-buffer-shorten-path x (ivy-rich-minibuffer-width 0.3))))))
                      :predicate
                      (lambda (cand)
                        (if-let ((buffer (get-buffer cand)))
                            (with-current-buffer buffer
                              (not (derived-mode-p 'exwm-mode)))))))))
  #+end_src
** Ivy posframe
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package ivy-posframe
    :ensure t
    :config
    (setq ivy-posframe-display-functions-alist
          '((swiper          . ivy-posframe-display-at-point)
            (complete-symbol . ivy-posframe-display-at-point)
            (counsel-M-x . ivy-display-function-fallback)
            (counsel-esh-history . ivy-posframe-display-at-window-center)
            (counsel-describe-function . ivy-display-function-fallback)
            (counsel-describe-variable . ivy-display-function-fallback)
            (counsel-find-file . ivy-posframe-display-at-window-center)
            (counsel-recentf . ivy-posframe-display-at-window-center)
            (counsel-register . ivy-posframe-display-at-frame-bottom-window-center)
            (dmenu . ivy-posframe-display-at-frame-top-center)
            (nil . ivy-posframe-display))
          ivy-posframe-height-alist
          '((swiper . 20)
            (dmenu . 20)
            (t . 10)))
    (ivy-posframe-mode +1)
    )
#+end_src


* Magit

#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
    (use-package magit
    :ensure t
    :commands (magit-status magit-get-current-branch)
    :custom
    (magit-display-buffer-function #'magit-display-buffer-same-window-except-diff-v1))

  #+end_src


* Editing Configuration
** Tab Widths
Default to an indentation size of 2
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
(setq-default tab-width 2)
(setq-default evil-shift-width tab-width)
#+end_src

** Spaces not tabs
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (setq-default indent-tabs-mode nil)
#+end_src

** Comments:
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (use-package evil-nerd-commenter
    :ensure t
    :bind
    ("M-/" . evilnc-comment-or-uncomment-lines))

#+end_src

** Mixed Pitch
A better verson of variable pitch.
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package mixed-pitch
    :ensure t
    :defer t
    :config
    (setq mixed-pitch-set-height nil)
    (dolist (face '(org-date org-priority org-tag org-special-keyword))
      (add-to-list 'mixed-pitch-fixed-pitch-faces face))
   )
#+end_src

* Hydra
** Fonts
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (defhydra rc-hydra-variable-fonts (:pre (mixed-pitch-mode 0)
                                          :post (mixed-pitch-mode 1))
    ("t" (set-face-attribute 'variable-pitch nil :family "Tinos" :height 160)             "Tinos")
    ("g" (set-face-attribute 'variable-pitch nil :family "EB Garamond" :height 160 :weight 'normal)             "EB Garamond")
    ("n" (set-face-attribute 'variable-pitch nil :family "Nunito" :slant 'normal :weight 'normal :height 160) "Nunito")
    ("s" (set-face-attribute 'variable-pitch nil :family "Spleen 32x64" :slant 'normal :weight 'normal :height 160) "Spleen")
    ("c" (set-face-attribute 'variable-pitch nil :family "Source Sans Pro" :slant 'normal :weight 'normal :height 160) "Source Sans Pro")
  )
#+end_src
** Dired
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(defhydra hydra-dired (:hint nil :color pink)
  "
_+_ mkdir          _v_iew           _m_ark             _(_ details        _i_nsert-subdir    wdired
_C_opy             _O_ view other   _U_nmark all       _)_ omit-mode      _$_ hide-subdir    C-x C-q : edit
_D_elete           _o_pen other     _u_nmark           _l_ redisplay      _w_ kill-subdir    C-c C-c : commit
_R_ename           _M_ chmod        _t_oggle           _g_ revert buf     _e_ ediff          C-c ESC : abort
_Y_ rel symlink    _G_ chgrp        _E_xtension mark   _s_ort             _=_ pdiff
_S_ymlink          ^ ^              _F_ind marked      _._ toggle hydra   \\ flyspell
_r_sync            ^ ^              ^ ^                ^ ^                _?_ summary
_z_ compress-file  _A_ find regexp
_Z_ compress       _Q_ repl regexp

T - tag prefix
"
  ("\\" dired-do-ispell)
  ("(" dired-hide-details-mode)
  (")" dired-omit-mode)
  ("+" dired-create-directory)
  ("=" diredp-ediff)         ;; smart diff
  ("?" dired-summary)
  ("$" diredp-hide-subdir-nomove)
  ("A" dired-do-find-regexp)
  ("C" dired-do-copy)        ;; Copy all marked files
  ("D" dired-do-delete)
  ("E" dired-mark-extension)
  ("e" dired-ediff-files)
  ("F" dired-do-find-marked-files)
  ("G" dired-do-chgrp)
  ("g" revert-buffer)        ;; read all directories again (refresh)
  ("i" dired-maybe-insert-subdir)
  ("l" dired-do-redisplay)   ;; relist the marked or singel directory
  ("M" dired-do-chmod)
  ("m" dired-mark)
  ("O" dired-display-file)
  ("o" dired-find-file-other-window)
  ("Q" dired-do-find-regexp-and-replace)
  ("R" dired-do-rename)
  ("r" dired-do-rsynch)
  ("S" dired-do-symlink)
  ("s" dired-sort-toggle-or-edit)
  ("t" dired-toggle-marks)
  ("U" dired-unmark-all-marks)
  ("u" dired-unmark)
  ("v" dired-view-file)      ;; q to exit, s to search, = gets line #
  ("w" dired-kill-subdir)
  ("Y" dired-do-relsymlink)
  ("z" diredp-compress-this-file)
  ("Z" dired-do-compress)
  ("q" nil)
  ("." nil :color blue))

(define-key dired-mode-map "." 'hydra-dired/body)
#+end_src

** Theme swticher
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
           (defhydra rc-hydra-theme-switcher (:hint nil)
             "
              Dark                ^Light^
         ----------------------------------------------
         _1_ one              _z_ one-light 
         _2_ vivendi          _x_ operandi
         _3_ molokai          _c_ ef-trio-light
         _4_ snazzy          MORE DARK BELOW
         _5_ old-hope         _v_     ef-dark
         _6_ henna            _b_     doom-dark+  
         _7_ kaolin-galaxy    _n_     iosevkm     
         _8_ monokai-machine  _m_     vibrant              
         _9_ xcode                ^
         _0_ moonlight            ^
         _-_ laserwave            ^    
         _q_ quit                 ^
         ^                        ^
           "
             ;; Dark
             ("1" (load-theme 'doom-one t)             "one")
             ("2" (load-theme 'modus-vivendi t)             "modus-vivendi")
             ("3" (load-theme 'doom-molokai t)             "molokai")
             ("4" (load-theme 'doom-snazzy t )             "snazzy")
             ("5" (load-theme 'doom-old-hope t)             "old hope")
             ("6" (load-theme 'doom-henna t)             "henna")
             ("7" (load-theme 'kaolin-galaxy t)             "jaolin-galaxy")
             ("8" (load-theme 'doom-monokai-machine t)             "monokai-machine")
             ("9" (load-theme 'doom-xcode t)             "xcode")
             ("0" (load-theme 'doom-moonlight t)             "moonlight")
             ("-" (load-theme 'doom-laserwave t)             "laserwave")
             ("z" (load-theme 'doom-one-light t)
              "one-light")
             ("x" (load-theme 'modus-operandi t)             "operand")
  ("c" (load-theme 'ef-trio-light t)             "ef-trio-light")
  ("v" (load-theme 'ef-dark t)             "ef-dark")
  ("b" (load-theme 'doom-dark+ t)             "doom-dark+")
  ("n" (load-theme 'doom-Iosvkem t)             "Iosvkem")
  ("m" (load-theme 'doom-vibrant t)             "vibrant")
   ("q" nil)

             )



#+end_src
** window commands
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (defhydra rc-hydra-window (:hint nil)
   "
Movement      ^Split^            ^Switch^        ^Resize^
----------------------------------------------------------------
_M-<left>_  <   _s_ vertical      _b_uffer        _<left>_  <
_M-<right>_ >   _v_ horizontal    _f_ind file     _<down>_  ↓
_M-<up>_    ↑   _m_aximize        _x_wap          _<up>_    ↑
_M-<down>_  ↓   _c_lose           _[_backward     _<right>_ >
_q_uit          _e_qualize        _]_forward     ^
^               ^               _K_ill         ^
^               ^                  ^             ^
"
   ;; Movement
   ("M-<left>" windmove-left)
   ("M-<down>" windmove-down)
   ("M-<up>" windmove-up)
   ("M-<right>" windmove-right)

   ;; Split/manage
   ("s" rc/split-window-vertically-and-switch)
   ("v" rc/split-window-horizontally-and-switch)
   ("c" evil-window-delete)
   ("d" evil-window-delete)
   ("m" delete-other-windows)
   ("e" balance-windows)

   ;; Switch
   ("b" counsel-switch-buffer)
   ("f" counsel-find-file)
   ("P" project-find-file)
   ("x" ace-swap-window)
   ("[" previous-buffer)
   ("]" next-buffer)
   ("K" kill-this-buffer)

   ;; Resize
   ("<left>" windresize-left)
   ("<right>" windresize-right)
   ("<down>" windresize-down)
   ("<up>" windresize-up)

   ("q" nil))
#+END_SRC
** Flycheck
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (defhydra hydra-flycheck
     (:pre (flycheck-list-errors)
      :post (quit-windows-on "*Flycheck errors*")
      :hint nil)
   "Errors"
   ("f" flycheck-error-list-set-filter "Filter")
   
   ("j" flycheck-next-error "Next")
   ("k" flycheck-previous-error "Previous")
   ("gg" flycheck-first-error "First")
   ("G" (progn (goto-char (point-max)) (flycheck-previous-error)) "Last")
   ("q" nil)) 
#+end_src
** Org
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
;; Hydra for org agenda (graciously taken from Spacemacs)
(defhydra hydra-org-agenda (:pre (setq which-key-inhibit t)
                                 :post (setq which-key-inhibit nil)
                                 :hint none)
  "
Org agenda (_q_uit)

^Clock^      ^Visit entry^              ^Date^             ^Other^
^-----^----  ^-----------^------------  ^----^-----------  ^-----^---------
_ci_ in      _SPC_ in other window      _ds_ schedule      _gr_ reload
_co_ out     _TAB_ & go to location     _dd_ set deadline  _._  go to today
_cq_ cancel  _RET_ & del other windows  _dt_ timestamp     _gd_ go to date
_cj_ jump    _o_   link                 _+_  do later      ^^
^^           ^^                         _-_  do earlier    ^^
^^           ^^                         ^^                 ^^
^View^          ^Filter^                 ^Headline^         ^Toggle mode^
^----^--------  ^------^---------------  ^--------^-------  ^-----------^----
_vd_ day        _ft_ by tag              _ht_ set status    _tf_ follow
_vw_ week       _fr_ refine by tag       _hk_ kill          _tl_ log
_vt_ fortnight  _fc_ by category         _hr_ refile        _ta_ archive trees
_vm_ month      _fh_ by top headline     _hA_ archive       _tA_ archive files
_vy_ year       _fx_ by regexp           _h:_ set tags      _tr_ clock report
_vn_ next span  _fd_ delete all filters  _hp_ set priority  _td_ diaries
_vp_ prev span  ^^                       ^^                 ^^
_vr_ reset      ^^                       ^^                 ^^
^^              ^^                       ^^                 ^^
"
  ;; Entry
  ("hA" org-agenda-archive-default)
  ("hk" org-agenda-kill)
  ("hp" org-agenda-priority)
  ("hr" org-agenda-refile)
  ("h:" org-agenda-set-tags)
  ("ht" org-agenda-todo)
  ;; Visit entry
  ("o"   link-hint-open-link :exit t)
  ("<tab>" org-agenda-goto :exit t)
  ("TAB" org-agenda-goto :exit t)
  ("SPC" org-agenda-show-and-scroll-up)
  ("RET" org-agenda-switch-to :exit t)
  ;; Date
  ("dt" org-agenda-date-prompt)
  ("dd" org-agenda-deadline)
  ("+" org-agenda-do-date-later)
  ("-" org-agenda-do-date-earlier)
  ("ds" org-agenda-schedule)
  ;; View
  ("vd" org-agenda-day-view)
  ("vw" org-agenda-week-view)
  ("vt" org-agenda-fortnight-view)
  ("vm" org-agenda-month-view)
  ("vy" org-agenda-year-view)
  ("vn" org-agenda-later)
  ("vp" org-agenda-earlier)
  ("vr" org-agenda-reset-view)
  ;; Toggle mode
  ("ta" org-agenda-archives-mode)
  ("tA" (org-agenda-archives-mode 'files))
  ("tr" org-agenda-clockreport-mode)
  ("tf" org-agenda-follow-mode)
  ("tl" org-agenda-log-mode)
  ("td" org-agenda-toggle-diary)
  ;; Filter
  ("fc" org-agenda-filter-by-category)
  ("fx" org-agenda-filter-by-regexp)
  ("ft" org-agenda-filter-by-tag)
  ("fr" org-agenda-filter-by-tag-refine)
  ("fh" org-agenda-filter-by-top-headline)
  ("fd" org-agenda-filter-remove-all)
  ;; Clock
  ("cq" org-agenda-clock-cancel)
  ("cj" org-agenda-clock-goto :exit t)
  ("ci" org-agenda-clock-in :exit t)
  ("co" org-agenda-clock-out)
  ;; Other
  ("q" nil :exit t)
  ("gd" org-agenda-goto-date)
  ("." org-agenda-goto-today)
  ("gr" org-agenda-redo))
#+end_src
** Avy
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(defhydra hydra-avy (:exit t :hint nil)
  "
 Line^^       Region^^        Goto
----------------------------------------------------------
 [_y_] yank   [_Y_] yank      [_c_] timed char  [_C_] char
 [_m_] move   [_M_] move      [_w_] word        [_W_] any word
 [_k_] kill   [_K_] kill      [_l_] line        [_L_] end of line"
  ("c" avy-goto-char-timer)
  ("C" avy-goto-char)
  ("w" avy-goto-word-1)
  ("W" avy-goto-word-0)
  ("l" avy-goto-line)
  ("L" avy-goto-end-of-line)
  ("m" avy-move-line)
  ("M" avy-move-region)
  ("k" avy-kill-whole-line)
  ("K" avy-kill-region)
  ("y" avy-copy-line)
  ("Y" avy-copy-region))

#+end_src
** YasNippet
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(defhydra hydra-yasnippet (:color blue :hint nil)
  "
              ^YASnippets^
--------------------------------------------
  Modes:    Load/Visit:    Actions:

 _g_lobal  _d_irectory    _i_nsert
 _m_inor   _f_ile         _t_ryout
 _e_xtra   _l_ist         _n_ew
         _a_ll
"
  ("d" yas-load-directory)
  ("e" yas-activate-extra-mode)
  ("i" yas-insert-snippet)
  ("f" yas-visit-snippet-file :color blue)
  ("n" yas-new-snippet)
  ("t" yas-tryout-snippet)
  ("l" yas-describe-tables)
  ("g" yas/global-mode)
  ("m" yas/minor-mode)
  ("a" yas-reload-all))
#+end_src


* Keybinds
** Preamble
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (general-define-key
   :states '(normal motion visual)
   :keymaps 'override
   :prefix "SPC"

   ;; Top level functions
   "/" '(rc/rg :which-key "RipGrep")
   "SPC" '(counsel-M-x :which-key "M-x")
   "q" '(popper-kill-latest-popup :which-key "kill popup")
   "X" '(org-capture :which-key "Capture")
#+END_SRC
** Files
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  "f" '(nil :which-key "Files")
  "fd" '(counsel-dired-jump :which-key "Find directory")
  "ff" '(counsel-find-file :which-key "Find file")
  "fl" '(counsel-locate :which-key "Locate")
  "fr" '(counsel-recentf :which-key "Recent Files")
  "fR" '(counsel-find-file-move :which-key "Move File")
  "fs" '(save :which-key "Save")

#+end_src


** Buffers
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Buffers
  "b" '(nil :which-key "Buffer")
  "bb" '(persp-counsel-switch-buffer :which-key "Switch buffer")
  "bd" '(evil-delete-buffer :which-key "Delete buffer")
  "bm" '(rc/kill-other-buffers :which-key "Kill other buffers")
  "bi" '(ibuffer :which-key "iBuffer")
  "br" '(revert-buffer :which-key "Revert buffer")
  "bn" '(next-buffer :which-key "Next")
  "bp" '(previous-buffer :which-key "Prev")


#+END_SRC

** Code
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; lCode

  "c" '(nil :which-key "Code")
  "cd" '(lsp-ui-peek-find-definitions :which-key "Definition")
  "cR" '(lsp-ui-peek-find-references :which-key "References")
  "ca" '(lsp-execute-code-action :which-key "Code action")
  "ci" '(lsp-ui-peek-find-implementation :which-key "Implementations")
  "cD" '(lsp-goto-type-definition :which-key "Type Def.")
  "cc" '(lsp-treemacs-call-hierarchy :which-key "Call hierarchy")
  "ct" '(lsp-treemacs-type-hierarchy :which-key "Type hierarchy")
  "cs" '(lsp-treemacs-symbols :which-key "Symbol Hierarchy")
  "cT" '(lsp-treemacs-tree :which-key "Tree")
  "ce" '(nil :which-key "Errors")
  "cek" '(flycheck-previous-error :which-key "Prev Error")
  "cej" '(flycheck-next-error :which-key "Next Error")
  "ceg" '(flycheck-first-error :which-key "First Error")
  "cef" '(flycheck-error-list-set-filter :which-key "Filter")
  "ceG" '((progn (goto-char (point-max)) (flycheck-previour-error)) :which-key "Last Error")
  "cel" '(counsel-flycheck :which-key "Error List")
  "cee" '(flycheck-explain-error-at-point :which-key "Explain error")

  "cf" '(nil :which-key "Format")
  "cfl" '(lsp-format-buffer :which-key "LSP format Buffer")
  "cfa" '(apheleia-format-buffer :which-key "Apheleia Format")
  "cfr" '(lsp-format-region :which-key "LSP Format Region")
  "cft" '(lsp-on-type-formatting :which-key "Toggle On Type Formatting")
#+END_SRC

** Bookmarks
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  "m" '(nil :which-key "Bookmarks")
  "ma" '(bookmark-set  :which-key "Set a bookmark")
  "mj" '(bookmark-jump-other-window :which-key "Jump to bookmark")
  "mJ" '(bookmark-jump :which-key "Jump Here")
  "mb" '(counsel-bookmark :which-key "Set or Jump")
  "md" '(counsel-bookmark-avoid-dired :which-key "Jump to Directory")
  
#+end_src

** Files
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
       ;;Files.
       "f" '(nil :which-key "files")
       "fb" '(counsel-bookmark :which-key "bookmarks")
       "ff" '(counsel-find-file :which-key "find file")
       "fr" '(counsel-recentf :which-key "recent files")
       "fR" '(rename-file :which-key "rename file")
       "fs" '(save-buffer :which-key "save buffer")
       "fS" '(evil-write-all :which-key "save all buffers")
#+END_SRC

** Projects
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  "p" '(nil :which-key "Projects")
  "pp" '(counsel-projectile-switch-project :which-key "Switch Project")
  "pf" '(counsel-projectile-find-file :which-key "Files")
  "pd" '(counsel-projectile-find-dir :which-key "Directories")
  "pb" '(counsel-projectile-switch-to-buffer :which-key "Buffers")
  "pg" '(counsel-projectile-rg :which-key "RipGrep")
   "pX" '(counsel-projectile-org-capture :which-key "Capture")
  "pa" '(counsel-projectile-org-agenda :which-key "Agenda")
#+end_src

** Hydra
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Hydras
  "H" '(nil :which-key "Hydras")
  "Hs" '(hydra-text-scale/body :which-key "Scale text")
  "Ht" '(rc-hydra-theme-switcher/body :which-key "themes")
  "Hf" '(rc-hydra-variable-fonts/body :which-key "mixed-pitch face")
  "Hw" '(rc-hydra-window/body :which-key "Window Control")
  "Hd" '(hydra-dired/body :which-key "Dired")
  "He" '(hydra-flycheck/body :which-key "Diagnostics")
  "Ho" '(hydra-org-agenda/body :which-key "Org Agenda")
  "Ha" '(hydra-avy/body :which-key "Avy")
  "Hy" '(hydra-yasnippet :which-key "YASnippet")
#+END_SRC

** Help
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Help/emacs
  "h" '(nil :which-key "help/emacs")

  "hv" '(helpful-variable :which-key "des. variable")
  "hb" '(counsel-descbinds :which-key "des. bindings")
  "hM" '(describe-mode :which-key "des. mode")
  "hf" '(helpful-function :which-key "des. func")
  "hF" '(counsel-describe-face :which-key "des. face")
  "hk" '(helpful-key :which-key "des. key")

  "hed" '((lambda () (interactive) (jump-to-register 67)) :which-key "edit dotfile")

  "hm" '(nil :which-key "switch mode")
  "hme" '(elisp-mode :which-key "elisp mode")
  "hmo" '(org-mode :which-key "org mode")
  "hmt" '(text-mode :which-key "text mode")

  "hp" '(nil :which-key "packages")
  "hpr" 'package-refresh-contents
  "hpi" 'package-install
  "hpd" 'package-delete

#+END_SRC

** Window
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el

  ;; Windows
         "w" '(nil :which-key "window")
         "wm" '(rc/toggle-maximize-buffer :which-key "maximize buffer")
         "wN" '(make-frame :which-key "make frame")
         "wd" '(evil-window-delete :which-key "delete window")
         "ws" '(rc/split-window-vertically-and-switch :which-key "split below")
         "wv" '(rc/split-window-horizontally-and-switch :which-key "split right")
         "wr" '(rc-hydra-window/body :which-key "hydra window")
         "wl" '(evil-window-right :which-key "evil-window-right")
         "wh" '(evil-window-left :which-key "evil-window-left")
         "wj" '(evil-window-down :which-key "evil-window-down")
         "wk" '(evil-window-up :which-key "evil-window-up")
  "wz" '(text-scale-adjust :which-key "text zoom")
  "wu" '(winner-undo :which-key "Winnder undo")
  "wU" '(winner-redo :which-key "Winner Redo")
#+END_SRC
** Registers
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  "r" '(nil :which-key "Registers")
  "rc" '(copy-to-register :which-key "Copy to Register")
  "rf" '(frameset-to-register :which-key "Frameset to register")
  "ri" '(insert-register :which-key "Insert contents of register")
  "rj" '(jump-to-register :which-key "Jump to")
  "rl" '(list-registers :which-key "List registers")
  "rn" '(number-to-register :which-key "Number to register")
  "rr" '(counsel-register :which-key "Choose a register")
  "rv" '(view-register :which-key "View register")
  "rw" '(window-configuration-to-register :which-key "Window config to register")
  "r+" '(increment-register :which-key "Increment register")
  "r " '(point-to-register :which-key "Point to Register")
#+end_src
** Workspaces
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  "s" '(nil :which-key "Work[s]paces")
  "ss" '(persp-switch :which-key "Switch")
  "sn" '(persp-switch-by-number :which-key "Swich By #")
  "sk" '(persp-remove-buffer :which-key "Remove Buffer")
  "sd" '(persp-kill :which-key "Delete workspace")
  "sr" '(persp-rename :which-key "Rename")
  "sa" '(persp-add-buffer :which-key "Add a buffer")
  "sc" '(persp-set-buffer :which-key "Claim buffer for perspective")
  "sb" '(persp-switch-to-buffer :which-key "Switch to buffer (in any perspective)")
  "sS" '(persp-state-save :which-key "Save")
  "sL" '(persp-state-load :which-key "Load")
#+end_src


** Toggles
#+BEGIN_SRC emacs-lisp :results none :tangle ~/.emacs.d/init.el
  ;; Toggles
  "t" '(nil :which-key "toggles")
  "tm" '(modus-themes-toggle :which-key "Modus Themes")
  "ta" '(term-toggle-ansi :which-key "Ansi Term")
  "tA" '(ansi-term :which-key "Ansi Term (HERE)")
  "tt" '(term-toggle-term :which-key "Term")
  "tT" '(term :which-key "Term (HERE)")
  "te" '(term-toggle-eshell :which-key "Eshell")
  "tE" '(eshell :which-key "Eshell (HERE)")
  "td" '(dired :which-key "Dired")
  "tp" '(treemacs :which-key "Treemacs")
  ) ;; End SPC prefix block
#+end_src

#+RESULTS:

** DONE Global keybinds
CLOSED: [2022-12-29 Thu 06:28]
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (general-def
    :keymaps 'override

    ;; Emacs
    "M-x" 'counsel-M-x
    )
  (general-def
    :keymaps 'override
    :states '(normal motion)
    "K" 'lsp-ui-doc-show
    "Q" 'popper-kill-latest-popup
  )
#+end_src

#+RESULTS:

** Non-insert mode bindings
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el
  (general-def
    :states '(normal visual motion)
    "gc" 'comment-dwim
    "gC" 'comment-line
    "u" 'undo-fu-only-undo
    "U" 'undo-fu-only-redo
    "j" 'evil-next-visual-line
    "k" 'evil-previous-visual-line
    "f" 'evil-avy-goto-char-in-line
    )

  (general-def
    :states '(normal visual motion)
    :keymaps 'override
    "s" 'swiper)

  (general-def
    :states '(insert)
    "C-a" 'evil-beginning-of-visual-line
    "C-e" 'evil-end-of-visual-line
    "C-S-a" 'evil-beginning-of-line
    "C-S-e" 'evil-end-of-line
    "C-n" 'evil-next-visual-line
    "C-p" 'evil-previous-visual-line
    "TAB" 'yas-expand 

    )
#+end_src

#+RESULTS:

* TODO ADD:
** TODO open commonly used thigns
** TODO registers for common files


* Languages
** Web mode
#+begin_src emacs-lisp :results none :tangle ~/.emacs.d/init.el

  ;; (use-package web-mode
  ;;   :ensure t
  ;;   :defer t
  ;; :after lsp-mode
  ;;   :config
  ;;   (setq web-mode-enable-current-element-highlight t
  ;;         web-mode-enable-current-column-highlight t
  ;;         web-mode-enable-auto-quoting nil
  ;;         web-mode-markup-indent-offset 2
  ;;         web-mode-attr-indent-offset 2
  ;;         web-mode-attr-value-indent-offset 2)

  ;;   (define-derived-mode web-typescript-mode web-mode "TS [web]")
  ;;   (define-derived-mode web-js-mode web-mode "JS [web]")
  ;;   (define-derived-mode web-html-mode web-mode "HTML [web]")
  ;;   (add-to-list 'auto-mode-alist '("\\.html\\'" . web-mode))
  ;;   (add-to-list 'auto-mode-alist '("\\.[tj]sx?\\'" . web-mode))

  ;;   :general
  ;;   (general-def
  ;;     :prefix ","
  ;;     :states 'motion
  ;;     :keymaps 'web-mode-map
  ;;     "" nil
  ;;     "i" '(web-mode-buffer-indent :which-key "Web mode indent")
  ;;     "c" '(web-mode-fold-or-unfold :which-key "Web mode toggle fold")
  ;;     ))

#+end_src
** json
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  ;; (use-package json-mode :ensure t)       ;
#+end_src

** emacs-lisp-mode
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package emacs-lisp-mode
    :ensure nil
    :general
    (general-define-key
     :prefix ","
     :states 'motion
     :keymaps 'emacs-lisp-mode-map
     "" nil
     "e" '(nil :which-key "eval")
     "es" '(eval-last-sexp :which-key "eval-sexp")
     "er" '(eval-region :which-key "eval-region")
     "eb" '(eval-buffer :which-key "eval-buffer")

     "g" '(counsel-imenu :which-key "imenu")
     "c" '(check-parens :which-key "check parens")
     "I" '(indent-region :which-key "indent-region")
     "b" '(nil :which-key "org src")
     "bc" '(org-edit-src-abort :which-key "Abort")
     "bb" '(org-edit-src-exit :which-key "Save & Exit")
     )


    )
#+end_src
** typescript tide

#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (defun tide-setup-hook()
    (tide-setup)
    (eldoc-setup)
    (flycheck-set-indication-mode +1)
    (tide-hl-identifier-mode +1)
    (set (make-local-variable 'company-backends)
         '((company-tide company-files :with company-yasnippet
                         company-dabbrev-code company-dabbrev))))

  (use-package tide
    :ensure t
    :after (company flycheck)
    :hook (
           (before-save . tide-format-before-save)
           (tsx-ts-mode-hook . tide-setup-hook)
           (js-mode-hook . tide-setup-hook)
           (typescript-mode-hook . tide-setup-hook)
           )
   :config
    (flycheck-add-mode 'typescript-tslint 'typescript-mode)
   (flycheck-add-next-checker 'javascript-eslint 'javascript-tide 'append)



  :general
  (general-def
    :prefix "SPC"
  :states 'normal
  :keymap: 'override

    "j"  '(nil :whick-key "Tide (TS/JS)")
    "jr" '(tide-refactor :which-key "Refactor")
    "jo" '(tide-organize-imports :which-key "Organize Imports")
    "jR" '(tide-rename-file :which-key "Rename the files and references")
    "js" '(tide-rename-symbol :which-key "Rename symbol")
    "je" '(tide-error-at-point :which-key "Error details at point")

      ))


#+END_SRC


* Dashboard
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
  (use-package dashboard
    :ensure t
    :config
    (dashboard-setup-startup-hook))
  (setq dashboard-banner-logo-title "")
  (setq dashboard-startup-banner "~/.emacs.d/ka.png")

  (setq initial-buffer-choice (lambda () (get-buffer-create "*dashboard*"))    )

  #+end_src
* kill the scratch on startup
#+begin_src emacs-lisp :tangle ~/.emacs.d/init.el :results none
(add-hook 'emacs-startup-hook (lambda ()
                                (when (get-buffer "*scratch*")
                                  (kill-buffer "*scratch*"))))
#+end_src
